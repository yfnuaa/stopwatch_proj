C51 COMPILER V9.01   KEYPROCESS                                                            12/20/2018 20:23:42 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE KEYPROCESS
OBJECT MODULE PLACED IN keyprocess.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE src\keyprocess.c COMPACT BROWSE PRINT(.\keyprocess.lst) OBJECT(keyprocess.o
                    -bj)

line level    source

   1          #include "../h/port.h"
   2          #include "../h/serial.h"
   3          #include "../h/stopwatch.h"
   4          #include "../h/keyprocess.h"
   5          sbit g_key_state = P1^0;
   6          
   7          #define PUSHED 0
   8          #define POPED 1
   9          bit volatile g_key_released = 0;
  10          bit volatile g_key_pressed = 0;
  11          uchar volatile g_key_pressing_1s = 0;
  12          
  13          bit g_key_juggle_start =0;
  14          
  15          void process_key(void)
  16          {
  17   1          static int delay = 0;
  18   1          if(delay > 1)
  19   1          {
  20   2              delay--;
  21   2              return;
  22   2          }
  23   1          if(PUSHED == g_key_state && 0 == g_key_pressed&& 0 == g_key_pressing_1s && delay == 0)
  24   1          {
  25   2              delay = 100;
  26   2              return;
  27   2          }
  28   1          //else if(0 == g_key_pressed && 0 == g_key_pressing_1s && delay == 1)
  29   1          {
  30   2              delay = 0;
  31   2          }
  32   1      
  33   1          if(PUSHED == g_key_state)
  34   1          {
  35   2             if(0 == g_key_pressing_1s)
  36   2             {
  37   3                 g_key_pressed = 1;send_buffer("PUSHED");
  38   3                 g_key_pressing_1s = 1;
  39   3                 g_1s_key_timer = e_timer_start;
  40   3             }
  41   2             else
  42   2             {
  43   3                 g_key_pressed = 0;
  44   3                 if(g_1s_key_timer == e_timer_finished)
  45   3                 {
  46   4                     g_1s_key_timer = e_timer_start;
  47   4                     g_key_pressing_1s++;
  48   4                 }
  49   3             }
  50   2             g_key_released = 0;
  51   2          }
  52   1          else
  53   1          {
  54   2             if(g_key_pressing_1s)
C51 COMPILER V9.01   KEYPROCESS                                                            12/20/2018 20:23:42 PAGE 2   

  55   2             {
  56   3                 g_key_released = 1; send_buffer("key releasexxd");
  57   3                 g_key_pressed  = 0;
  58   3                 g_key_pressing_1s = 0;
  59   3             }
  60   2             else
  61   2             {
  62   3                 g_key_released = 0;
  63   3             }  
  64   2          }
  65   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    129    ----
   CONSTANT SIZE    =     22    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =      3    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
