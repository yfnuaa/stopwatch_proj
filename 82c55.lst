C51 COMPILER V9.01   82C55                                                                 09/15/2018 09:06:03 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE 82C55
OBJECT MODULE PLACED IN 82c55.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE src\82c55.c BROWSE PRINT(.\82c55.lst) OBJECT(82c55.obj)

line level    source

   1          #include "reg52.h"
   2          #include "../h/utility.h"
   3          sbit    nec8255cs  =  P2^2;
   4          sbit    nec8255rd  =  P2^7;
   5          sbit    nec8255A1  =  P2^4;
   6          sbit    nec8255A0  =  P2^5;
   7          sbit    nec8255wr  =  P2^6;     
   8          sbit    nec8255rst =  P2^3; 
   9          //#define dateread  //(P1^7<<7+P1^6<<6+P1^5<<5+P1^4<<4+P1^3<<3+P1^2<<2+P1^1<<1+P1^0)
  10          
  11          void nec82c55_init()
  12          {
  13   1          nec8255rd=1;
  14   1              nec8255wr=1;
  15   1              nec8255cs=0;
  16   1          nec8255rst=0;
  17   1              nec8255rst=1;
  18   1              Delay(4);
  19   1              nec8255rst=0;
  20   1          //nec8255cs=1;      
  21   1      }
  22          
  23          void nec82c55_read(unsigned char port,unsigned char * value)
  24          {               //nec8255cs=0;
  25   1                 #if 0
                      //写0到所有口  初始化口子状态
                              nec8255A0=1;
                              nec8255A1=1;
                              P0=0x80;          //所有口输出
                              
                              nec8255wr=0;
                              Delay(1);
                              nec8255wr=1;
                      //      Delay(10);
                               //口子功能设置结束
                          
                              nec8255A0=0x1&port;
                              nec8255A1=(0x2&port)>>1;
                          P0=0;         
                              nec8255wr=0;
                              Delay(1);
                              nec8255wr=1;
                              Delay(10);
              
                      //开始读  把口子功能设置回来，设置为输入
                      nec8255A0=1;
                              nec8255A1=1;
                              P0=0x9B;          //所有口输入
                              nec8255wr=0;
                              Delay(1);
                              nec8255wr=1;
                              Delay(10);
                                               //口子功能设置结束
               #endif
  55   1              nec8255A0=0x1&port;
C51 COMPILER V9.01   82C55                                                                 09/15/2018 09:06:03 PAGE 2   

  56   1                      nec8255A1=(0x2&port)>>1;        
  57   1                      Delay(1);
  58   1                      nec8255rd=0;
  59   1                      Delay(10);
  60   1                      *value= P0;//date read;
  61   1                      nec8255rd=1;
  62   1              //      nec8255cs=1;
  63   1      }
  64          //inlines        void relay_on(unsigned char arry,unsigned char on_off)
  65          //       {
  66          //              P0^array=on_off;
  67                   
  68          //       }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     81    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
