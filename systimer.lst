C51 COMPILER V9.01   SYSTIMER                                                              01/14/2019 21:22:33 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE SYSTIMER
OBJECT MODULE PLACED IN systimer.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE src\systimer.c COMPACT BROWSE PRINT(.\systimer.lst) OBJECT(systimer.obj)

line level    source

   1          #include "../h/port.h"
   2          #include "../h/systimer.h"                                                                                
             -         ////////main.c main.c main.c////////////////////
   3          #include "../h/serial.h"
   4          #include "../h/alarm.h"
   5          
   6          unsigned int volatile g_sys_10ms_ticket = 0;
   7          void Time0(void) interrupt 1 using 1  //“interrupt”声明函数为中断服务函数
   8          //其后的1 为定时器T0 的中断编号；0 表示使用第0 组工作
   9          {
  10   1          g_sys_10ms_ticket++;
  11   1      }
  12           
  13           void init_timer(void)
  14          {
  15   1      
  16   1          //AUXR &= 0x7F;//    定时器0T
  17   1              AUXR |=0X80;
  18   1          //start up a 1ms timer
  19   1          TMOD &= 0xF0; //使用          定时器T0            的模式2
  20   1       #ifdef SYS_HZ_4M     //4M 1ms
  21   1          TL0=0xC0;//0x30;//(65536-56083)%256; //定时器T0 的高8 位赋初值
  22   1          TH0=0x63;//0xf8;//(65536-56083)/256; //定时器T0 的高8 位赋初值
  23   1       #endif    //27M  1ms
  24   1      #ifdef SYS_HZ_6M     //6M 1ms
                  TL0=0x0c;//0x30;//(65536-56083)%256; //定时器T0 的高8 位赋初值
                  TH0=0xFe;//0xf8;//(65536-56083)/256; //定时器T0 的高8 位赋初值
               #endif    //27M  1ms
  28   1       #ifdef SYS_HZ_27M
                  TL0= 0x36;//(65536-56083)%256; //定时器T0 的高8 位赋初值
                  TH0= 0xf7;//(65536-56083)/256; //定时器T0 的高8 位赋初值
               #endif
  32   1          EA=1; //开总中断
  33   1          TF0 = 0;
  34   1          ET0=1; //定时器T0 中断允许    
  35   1          TR0=1; //启动定时器T0
  36   1      }
  37          void stop_sys_timer(void)
  38          {
  39   1      TR0= 0 ;
  40   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     47    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =      2    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
