C51 COMPILER V9.01   LED                                                                   11/07/2018 13:42:33 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE LED
OBJECT MODULE PLACED IN led.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE src\led.c LARGE BROWSE PRINT(.\led.lst) OBJECT(led.obj)

line level    source

   1          #include "../h/port.h"
   2          #include "../h/led.h"
   3          #include "../h/stopwatch.h"
   4          #include "../h/utility.h"
   5          #include "../h/serial.h"
   6          sbit g_LED4 = P0^7;
   7          sbit g_LED3 = P2^6;
   8          sbit g_LED2 = P2^5;
   9          sbit g_LED1 = P2^4;
  10          
  11          sbit g_seg_a  = P0^4;
  12          sbit g_seg_b  = P0^6;
  13          sbit g_seg_c  = P0^2;
  14          sbit g_seg_d  = P0^0;
  15          sbit g_seg_e  = P2^7;
  16          sbit g_seg_f  = P0^5;
  17          sbit g_seg_g  = P0^3;
  18          sbit g_seg_dp = P0^1;
  19          uchar       BCD_table[] = { 0x00,0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,
  20                                      0x10,0x11,0x12,0x13,0x14,0x15,0x16,0x17,0x18,0x19,
  21                                      0x20,0x21,0x22,0x23,0x24,0x25,0x26,0x27,0x28,0x29,
  22                                      0x30,0x31,0x32,0x33,0x34,0x35,0x36,0x37,0x38,0x39,
  23                                      0x40,0x41,0x42,0x43,0x44,0x45,0x46,0x47,0x48,0x49,
  24                                      0x50,0x51,0x52,0x53,0x54,0x55,0x56,0x57,0x58,0x59,
  25                                      0x60,0x61,0x62,0x63,0x64,0x65,0x66,0x67,0x68,0x69,
  26                                      0x70,0x71,0x72,0x73,0x74,0x75,0x76,0x77,0x78,0x79,
  27                                      0x80,0x81,0x82,0x83,0x84,0x85,0x86,0x87,0x88,0x89,
  28                                      0x90,0x91,0x92,0x93,0x94,0x95,0x96,0x97,0x98,0x99 
  29                                                            };
  30          uchar DIG_CODE[10] = {0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f}; //数码管数字表
  31                                        
  32          void flash_display(void)
  33          {                            
  34   1          static char sig = 1;
  35   1          unsigned char cdata=0;      
  36   1          if(g_blink_off_flag){g_LED4 = g_LED3 = g_LED2 = g_LED1 = 1; return;}
  37   1      
  38   1          switch(sig)
  39   1          {
  40   2              case 1:
  41   2                  cdata = BCD_table[g_timer_to_count_min]>>4;//g_timer_to_count_min/10;
  42   2                  g_LED4 = 1; //g_LED1 = 0;     
  43   2              break;
  44   2              case 2:
  45   2                  cdata = BCD_table[g_timer_to_count_min]&0xF;//g_timer_to_count_min%10;
  46   2                  g_LED1 = 1; //g_LED2 = 0;
  47   2              break;
  48   2              case 3:
  49   2                  cdata = BCD_table[g_timer_to_count_sec]>>4;//g_timer_to_count_sec/10;
  50   2                  g_LED2 = 1; //g_LED3 = 0;
  51   2              break;
  52   2              case 4:
  53   2                  cdata = BCD_table[g_timer_to_count_sec]&0xF;//g_timer_to_count_sec%10; 
  54   2                  g_LED3 = 1; //g_LED4 = 0;
  55   2              break;
C51 COMPILER V9.01   LED                                                                   11/07/2018 13:42:33 PAGE 2   

  56   2          }    
  57   1          // send_buffer("ledd",4);
  58   1          // P0 = (~DIG_CODE[cdata]);
  59   1          g_seg_a = (~ DIG_CODE[cdata]    )&1;
  60   1          g_seg_b = (~(DIG_CODE[cdata]>>1))&1;
  61   1          g_seg_c = (~(DIG_CODE[cdata]>>2))&1;
  62   1          g_seg_d = (~(DIG_CODE[cdata]>>3))&1;
  63   1          g_seg_e = (~(DIG_CODE[cdata]>>4))&1;
  64   1          g_seg_f = (~(DIG_CODE[cdata]>>5))&1;
  65   1          g_seg_g = (~(DIG_CODE[cdata]>>6))&1;
  66   1          g_seg_dp= (~(DIG_CODE[cdata]>>7))&1;
  67   1          if(1 == sig)
  68   1          {
  69   2              g_LED1 = 0;
  70   2          }
  71   1          else if(2 == sig)
  72   1          {
  73   2              g_LED2 = 0;
  74   2              g_seg_dp = 0;
  75   2          }
  76   1          else if(3 == sig)
  77   1          {
  78   2              g_LED3 = 0;
  79   2          }
  80   1          else
  81   1          {
  82   2              g_LED4 = 0;
  83   2          }
  84   1          if(++sig == 5)sig = 1;
  85   1      }
  86          
  87          void black_display(void)
  88          {
  89   1          g_LED4 = g_LED3 = g_LED2 = g_LED1=1;  g_seg_dp = 1;
  90   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    310    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =    111    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
